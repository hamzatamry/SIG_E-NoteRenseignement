<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-menu-button menu="profile"></ion-menu-button>
    </ion-buttons>
    <ion-title>Agence Urbaine de Settat AUS</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>

  <form #publicationForm="ngForm" (ngSubmit)="publish(publicationForm)">
    <ion-card>
      <ion-card-header>
        <ion-card-title>
          <ion-input 
            type="text" 
            name="title"
            ngModel
            maxlength="50"
            required
            placeholder="Votre titre de publication">
          </ion-input>
        </ion-card-title> 
        <ion-card-subtitle>Hamza Tamry</ion-card-subtitle>
      </ion-card-header>
  
      <ion-card-content>

        <ion-textarea 
          name="text" 
          ngModel
          placeholder="Ajouter un texte Ã  votre publication">
        </ion-textarea>

        <ion-toolbar>
          <ion-buttons *ngFor="let file of selectedFiles">
            <ion-item>
              <ion-label>{{ getFileName(file.name) }}</ion-label>
              <ion-icon></ion-icon>
            </ion-item>
          </ion-buttons>
        </ion-toolbar>

        <ion-toolbar>
          <ion-buttons>
            <ion-button type="submit">Publier</ion-button>
            <ion-button (click)="filePicker.click()">
              <ion-icon name="attach-outline"></ion-icon>
            </ion-button>
            
            <input #filePicker
              type="file" (change)="onFileSelected($event)"
              name="file"
              ngModel
              accept="application/pdf" />
          </ion-buttons>
        </ion-toolbar>
        

      </ion-card-content>
    </ion-card>
  </form>
  

  <ion-list>
    <ion-card *ngFor="let publication of publications">
      <ion-card-header>
        <ion-card-title>{{ publication.title }}</ion-card-title>
        <ion-card-subtitle> {{ publication.agencyStaff.firstName + " " + publication.agencyStaff.lastName }} </ion-card-subtitle>
        <ion-label> {{ publication.date }} </ion-label>
      </ion-card-header>

      <ion-card-content>
        <ion-text>
          {{ publication.description }}
        </ion-text>
        
        <ion-list>
          <ion-item *ngFor="let comment of [1, 2, 3]">
            <ion-label position="stacked">Mohammed jizeoze</ion-label>
            <ion-text>
              zijgozejgoize
              zeogjzejgzoeg
              ziejgoizejgioze
            </ion-text>
          </ion-item>
          

          <form #commentForm="ngForm" (ngSubmit)="comment(commentForm, publication.id)">
            <ion-item>
              <ion-textarea 
                type="text" 
                name="message"
                ngModel
                required
                maxlength="100"
                placeholder="Votre commentaire...">
              </ion-textarea>

              <ion-button 
                [disabled]="!commentForm.valid && commentForm.touched" 
                type="submit">Envoyer<ion-icon name="send"></ion-icon>
              </ion-button>
            </ion-item>
          </form>
          
        </ion-list>
      </ion-card-content>
    </ion-card>
  </ion-list>
</ion-content>
